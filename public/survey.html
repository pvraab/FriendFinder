<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Survey</title>

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

  <!-- jQuery -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>

  <!-- Use popper for the dropdown menus -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>

  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>

</head>

<body>

  <div class="container">

    <div class="jumbotron">
      <h1 class="text-center"><span class="fa fa-fire"></span> Survey</h1>
      <hr>
      <h2 class="text-center">Answer The Questions</h2>
      <br>

      <div class="text-center">
        <a href="/"><button class="btn btn-lg btn-default"><span class="fa fa-home"></span></button></a>
      </div>
    </div>

    <div class="row">
      <div class="col-lg-12">

        <!-- Survey -->
        <div class="card">
          <div class="card-header">
            <h4>Take A Survey</h4>
          </div>
          <div class="card-body">
            <form role="form">

              <h2>About You</h2>

              <div class="form-group row">
                <label class="col-sm-3 col-form-label col-form-label-sm" for="friend-name">Name</label>
                <div class="col-sm-9">
                  <input type="text" class="form-control form-control-sm" id="friend-name">
                </div>
              </div>

              <div class="form-group row">
                <label class="col-sm-3 col-form-label col-form-label-sm" for="friend-photo">Photo</label>
                <div class="col-sm-9">
                  <input type="text" class="form-control form-control-sm" id="friend-photo">
                </div>
              </div>

              <div class="form-group row">
                <h3><strong>Question 1</strong></h3></label>
              </div>
              <div class="form-group row">
                <h4>World peace is the thing</h4>
              </div>
              <div class="form-group row">
                <div class="dropdown">
                  <button type="button" class="btn btn-primary dropdown-toggle" id="button1" data-toggle="dropdown">
                    Select Option
                  </button>
                  <div class="dropdown-menu" id="dropdown-menu1">
                    <a class="dropdown-item" href="#">1 (Strongly Disagree)</a>
                    <a class="dropdown-item" href="#">2</a>
                    <a class="dropdown-item" href="#">3</a>
                    <a class="dropdown-item" href="#">4</a>
                    <a class="dropdown-item" href="#">5 (Strongly Agree)</a>
                  </div>
                </div>
              </div>

              <div class="form-group row">
                <h3><strong>Question 2</strong></h3></label>
              </div>
              <div class="form-group row">
                <h4>All you need is love</h4>
              </div>
              <div class="form-group row">
                <div class="dropdown">
                  <button type="button" class="btn btn-primary dropdown-toggle" id="button2" data-toggle="dropdown">
                    Select Option
                  </button>
                  <div class="dropdown-menu" id="dropdown-menu2">
                    <a class="dropdown-item" href="#">1 (Strongly Disagree)</a>
                    <a class="dropdown-item" href="#">2</a>
                    <a class="dropdown-item" href="#">3</a>
                    <a class="dropdown-item" href="#">4</a>
                    <a class="dropdown-item" href="#">5 (Strongly Agree)</a>
                  </div>
                </div>
              </div>

              <div class="form-group row">
                <h3><strong>Question 3</strong></h3></label>
              </div>
              <div class="form-group row">
                <h4>You can never have too many books</h4>
              </div>
              <div class="form-group row">
                <div class="dropdown">
                  <button type="button" class="btn btn-primary dropdown-toggle" id="button3" data-toggle="dropdown">
                    Select Option
                  </button>
                  <div class="dropdown-menu" id="dropdown-menu3">
                    <a class="dropdown-item" href="#">1 (Strongly Disagree)</a>
                    <a class="dropdown-item" href="#">2</a>
                    <a class="dropdown-item" href="#">3</a>
                    <a class="dropdown-item" href="#">4</a>
                    <a class="dropdown-item" href="#">5 (Strongly Agree)</a>
                  </div>
                </div>
              </div>

              <div class="form-group row">
                <h3><strong>Question 4</strong></h3></label>
              </div>
              <div class="form-group row">
                <h4>Party hardy</h4>
              </div>
              <div class="form-group row">
                <div class="dropdown">
                  <button type="button" class="btn btn-primary dropdown-toggle" id="button4" data-toggle="dropdown">
                    Select Option
                  </button>
                  <div class="dropdown-menu" id="dropdown-menu4">
                    <a class="dropdown-item" href="#">1 (Strongly Disagree)</a>
                    <a class="dropdown-item" href="#">2</a>
                    <a class="dropdown-item" href="#">3</a>
                    <a class="dropdown-item" href="#">4</a>
                    <a class="dropdown-item" href="#">5 (Strongly Agree)</a>
                  </div>
                </div>
              </div>

              <div class="form-group row">
                <h3><strong>Question 5</strong></h3></label>
              </div>
              <div class="form-group row">
                <h4>E = MC**2</h4>
              </div>
              <div class="form-group row">
                <div class="dropdown">
                  <button type="button" class="btn btn-primary dropdown-toggle" id="button5" data-toggle="dropdown">
                    Select Option
                  </button>
                  <div class="dropdown-menu" id="dropdown-menu5">
                    <a class="dropdown-item" href="#">1 (Strongly Disagree)</a>
                    <a class="dropdown-item" href="#">2</a>
                    <a class="dropdown-item" href="#">3</a>
                    <a class="dropdown-item" href="#">4</a>
                    <a class="dropdown-item" href="#">5 (Strongly Agree)</a>
                  </div>
                </div>
              </div>

              <div class="form-group row">
                <h3><strong>Question 6</strong></h3></label>
              </div>
              <div class="form-group row">
                <h4>Baseball is a great game</h4>
              </div>
              <div class="form-group row">
                <div class="dropdown">
                  <button type="button" class="btn btn-primary dropdown-toggle" id="button6" data-toggle="dropdown">
                    Select Option
                  </button>
                  <div class="dropdown-menu" id="dropdown-menu6">
                    <a class="dropdown-item" href="#">1 (Strongly Disagree)</a>
                    <a class="dropdown-item" href="#">2</a>
                    <a class="dropdown-item" href="#">3</a>
                    <a class="dropdown-item" href="#">4</a>
                    <a class="dropdown-item" href="#">5 (Strongly Agree)</a>
                  </div>
                </div>
              </div>

              <div class="form-group row">
                <h3><strong>Question 7</strong></h3></label>
              </div>
              <div class="form-group row">
                <h4>Children are a blessing</h4>
              </div>
              <div class="form-group row">
                <div class="dropdown">
                  <button type="button" class="btn btn-primary dropdown-toggle" id="button7" data-toggle="dropdown">
                    Select Option
                  </button>
                  <div class="dropdown-menu" id="dropdown-menu7">
                    <a class="dropdown-item" href="#">1 (Strongly Disagree)</a>
                    <a class="dropdown-item" href="#">2</a>
                    <a class="dropdown-item" href="#">3</a>
                    <a class="dropdown-item" href="#">4</a>
                    <a class="dropdown-item" href="#">5 (Strongly Agree)</a>
                  </div>
                </div>
              </div>

              <div class="form-group row">
                <h3><strong>Question 8</strong></h3></label>
              </div>
              <div class="form-group row">
                <h4>Let's go hiking</h4>
              </div>
              <div class="form-group row">
                <div class="dropdown">
                  <button type="button" class="btn btn-primary dropdown-toggle" id="button8" data-toggle="dropdown">
                    Select Option
                  </button>
                  <div class="dropdown-menu" id="dropdown-menu8">
                    <a class="dropdown-item" href="#">1 (Strongly Disagree)</a>
                    <a class="dropdown-item" href="#">2</a>
                    <a class="dropdown-item" href="#">3</a>
                    <a class="dropdown-item" href="#">4</a>
                    <a class="dropdown-item" href="#">5 (Strongly Agree)</a>
                  </div>
                </div>
              </div>

              <div class="form-group row">
                <h3><strong>Question 9</strong></h3></label>
              </div>
              <div class="form-group row">
                <h4>Till death do us part</h4>
              </div>
              <div class="form-group row">
                <div class="dropdown">
                  <button type="button" class="btn btn-primary dropdown-toggle" id="button9" data-toggle="dropdown">
                    Select Option
                  </button>
                  <div class="dropdown-menu" id="dropdown-menu9">
                    <a class="dropdown-item" href="#">1 (Strongly Disagree)</a>
                    <a class="dropdown-item" href="#">2</a>
                    <a class="dropdown-item" href="#">3</a>
                    <a class="dropdown-item" href="#">4</a>
                    <a class="dropdown-item" href="#">5 (Strongly Agree)</a>
                  </div>
                </div>
              </div>

              <div class="form-group row">
                <h3><strong>Question 10</strong></h3></label>
              </div>
              <div class="form-group row">
                <h4>Free college for all</h4>
              </div>
              <div class="form-group row">
                <div class="dropdown">
                  <button type="button" class="btn btn-primary dropdown-toggle" id="button10" data-toggle="dropdown">
                    Select Option
                  </button>
                  <div class="dropdown-menu" id="dropdown-menu10">
                    <a class="dropdown-item" href="#">1 (Strongly Disagree)</a>
                    <a class="dropdown-item" href="#">2</a>
                    <a class="dropdown-item" href="#">3</a>
                    <a class="dropdown-item" href="#">4</a>
                    <a class="dropdown-item" href="#">5 (Strongly Agree)</a>
                  </div>
                </div>
              </div>

              <button type="submit" class="btn btn-primary submit" id="submit">Submit</button>

            </form>

          </div>
        </div>

      </div>
    </div>

    <!-- Match Modal -->
    <div id="match-modal" class="modal fade" role="dialog">
      <div class="modal-dialog">

        <!-- Match-->
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal"></button>
            <h2 class="modal-title"><strong>Your Closest Friend</strong></h2>
          </div>
          <div class="modal-body">
            <h2 id="match-name"></h2>
            <h2 id="match-score"></h2>
            <img id="match-photo" src="" alt="">
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
          </div>
        </div>

      </div>
    </div>

    <footer class="footer mt-4">
      <div class="container">
        <p><a href="#" id="clear">Clear Friends</a> | <a href="/api/friends">API Friends List</a>
      </div>
    </footer>

  </div>

  <script type="text/javascript">
    // Create answer object 
    var ans = [
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      ""
    ];

    // Form submitted
    $("#submit").on("click", function (event) {
      event.preventDefault();

      // Check answers
      var test = checkAns();
      console.log(test);
      if (test.isGood) {
        // Create the new friend
        var friendData = {
          name: $("#friend-name").val(),
          photo: $("#friend-photo").val(),
          scores: [
            ans[0],
            ans[1],
            ans[2],
            ans[3],
            ans[4],
            ans[5],
            ans[6],
            ans[7],
            ans[8],
            ans[9]
          ]
        };
        console.log(friendData);

        // Post the object to the friends api
        $.post("/api/friends",
          friendData,
          function (data) {
            $("#match-name").text(data.name);
            $("#match-score").text(data.score);
            $("#match-photo").text(data.photo);

            // Display match in modal
            $("#match-modal").modal("toggle");

          });
      } else {
        alert("Missing answer " + test.index);
      }
    });

    // Check answers
    function checkAns() {
      var test = {
        isGood: true,
        index: 0
      };
      ans.forEach(function (elem, index) {
        if (elem === "") {
          test.isGood = false;
          test.index = index;
          return test;
        }
      });
      return test;
    };
    $("#dropdown-menu1 a ").click(function (event) {
      event.preventDefault();
      ans[0] = $(this).text();
      $("#button1").text(ans[0]);
    });
    $("#dropdown-menu2 a").click(function (event) {
      event.preventDefault();
      ans[1] = $(this).text();
      $("#button2").text(ans[1]);
    });
    $("#dropdown-menu3 a").click(function (event) {
      event.preventDefault();
      ans[2] = $(this).text();
      $("#button3").text(ans[2]);
    });
    $("#dropdown-menu4 a").click(function (event) {
      event.preventDefault();
      ans[3] = $(this).text();
      $("#button4").text(ans[3]);
    });
    $("#dropdown-menu5 a").click(function (event) {
      event.preventDefault();
      ans[4] = $(this).text();
      $("#button5").text(ans[4]);
    });
    $("#dropdown-menu6 a").click(function (event) {
      event.preventDefault();
      ans[5] = $(this).text();
      $("#button6").text(ans[5]);
    });
    $("#dropdown-menu7 a ").click(function (event) {
      event.preventDefault();
      ans[6] = $(this).text();
      $("#button7").text(ans[6]);
    });
    $("#dropdown-menu8 a ").click(function (event) {
      event.preventDefault();
      ans[7] = $(this).text();
      $("#button8").text(ans[7]);
    });
    $("#dropdown-menu9 a ").click(function (event) {
      event.preventDefault();
      ans[8] = $(this).text();
      $("#button9").text(ans[8]);
    });
    $("#dropdown-menu10 a ").click(function (event) {
      event.preventDefault();
      ans[9] = $(this).text();
      $("#button10").text(ans[9]);
    });
  </script>
</body>

</html>